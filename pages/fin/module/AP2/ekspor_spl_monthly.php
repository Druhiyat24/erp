<html>
<head>
    <title>Export Data SPL Monthly</title>
</head>
<body>
    <style type="text/css">
    body{
        font-family: sans-serif;
    }
    table{
        margin: 15px auto;
        border-style: none;
    }
    table th,
    table td{
        padding: 3px 8px;
 
    }
    a{
        background: blue;
        color: #fff;
        padding: 8px 10px;
        text-decoration: none;
        border-radius: 2px;
    }
    .text{
  mso-number-format:"\@";/force text/
}
    </style>
 
    <?php
    include '../../conn/conn.php';
    header("Content-type: application/vnd-ms-excel");
    header("Content-Disposition: attachment; filename=spl-ytd.xls");
    // $nama_supp =$_GET['nama_supp'];
    // $status =$_GET['status'];
    $bulan_awal = date("m",strtotime($_GET['start_date']));
    $bulan_akhir = date("m",strtotime($_GET['end_date']));
    $tahun_awal = date("Y",strtotime($_GET['start_date']));
    $tahun_akhir = date("Y",strtotime($_GET['end_date'])); 

    $sqlawal = mysqli_query($conn2,"select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal'");
    $rowawal = mysqli_fetch_array($sqlawal);
    $tgl_awal = isset($rowawal['tgl_awal']) ? $rowawal['tgl_awal'] : null;
    $start_date = date("d F Y",strtotime($tgl_awal));

    $sqlakhir = mysqli_query($conn2,"select tgl_akhir from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir'");
    $rowakhir = mysqli_fetch_array($sqlakhir);
    $tgl_akhir = isset($rowakhir['tgl_akhir']) ? $rowakhir['tgl_akhir'] : null;
    $end_date = date("d F Y",strtotime($tgl_akhir));


    $sql_periode = mysqli_query($conn2,"select DATE_FORMAT(periode, '%M %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");


    $sql_jmlper = mysqli_query($conn2,"select COUNT(periode) jml_periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");

    $rowjmlper = mysqli_fetch_array($sql_jmlper);
    $jmlper = isset($rowjmlper['jml_periode']) ? $rowjmlper['jml_periode'] : 0;

    ?>
<!-- 
    <center>
        <h4>TRIAL BALANCE YEAR TO DATE <br/> PERIODE <?php echo $start_date; ?> - <?php echo $end_date; ?></h4>
    </center> -->
  <!--   STATUS: <?php echo $status; ?> -->
 
    <table style="width:75%;font-size:14px;" >
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>PT NIRWANA ALABARE GARMENT</b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>PT NIRWANA ALABARE GARMENT</i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>LAPORAN LABA ATAU RUGI  DAN PENGHASILAN KOMPREHENSIF LAINNYA</b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>STATEMENTS OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME</i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>UNTUK TAHUN YANG BERAKHIR PADA TANGGAL <?php echo $end_date; ?></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>FOR THE YEARS ENDED <?php echo $end_date; ?></i></b></th>
        </tr>

        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>(Dinyatakan dalam Rupiah, kecuali dinyatakan lain)</b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>(Expressed in Rupiah, unless otherwise stated)</i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <?php
             while($periode = mysqli_fetch_array($sql_periode)){
            echo '<th class = "text" style="text-align: right;vertical-align: middle;width: 10%;">'.$periode['periode'].'</th>';
        };
            ?>
            <th style="text-align: center;vertical-align: middle;width: 10%;"><b>YTD</b></th>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <!-- penjualan-kotor - start -->
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>PENJUALAN KOTOR</b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>GROSS SALES</i></b></th>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Penjualan Pakaian Jadi Ekspor</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '411' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Garment Export Sales</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Penjualan Pakaian Jadi Lokal</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '412' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Garment Local Sales</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Penjualan Lainnya</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '418' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Other Sales</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Penjualan Jasa Jahit Pakaian Jadi Ekspor</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '413' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Export CMT Service Revenue</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Penjualan Jasa Jahit Pakaian Jadi Lokal</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '414' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Local CMT Service Revenue</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Penjualan Jasa Lainnya</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '419' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Other Service Revenue</i></td>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>TOTAL PENJUALAN KOTOR</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('411','412','418','413','414','419') group by a.id_ctg4 ) a");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>GROSS SALES TOTAL</i></b></th>
        </tr>
        
        <!-- penjualan-kotor - end -->

        <!-- return-penjualan - start -->
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>RETURN PENJUALAN</b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>SALES RETUN</i></b></th>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Retur Penjualan Pakaian Jadi Ekspor</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '421' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] * -1 : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] * -1 : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] * -1 : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] * -1 : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] * -1 : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] * -1 : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] * -1 : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] * -1 : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] * -1 : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] * -1 : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] * -1 : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] * -1 : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] * -1 : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] * -1 : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] * -1 : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] * -1 : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] * -1 : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] * -1 : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] * -1 : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] * -1 : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] * -1 : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] * -1 : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] * -1 : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] * -1 : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Garment Export Sales Return</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Retur Penjualan Pakaian Jadi Lokal</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '422' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] * -1 : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] * -1 : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] * -1 : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] * -1 : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] * -1 : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] * -1 : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] * -1 : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] * -1 : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] * -1 : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] * -1 : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] * -1 : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] * -1 : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] * -1 : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] * -1 : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] * -1 : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] * -1 : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] * -1 : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] * -1 : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] * -1 : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] * -1 : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] * -1 : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] * -1 : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] * -1 : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] * -1 : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Garment Local Sales Return</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Retur Penjualan Lainnya</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '429' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] * -1 : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] * -1 : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] * -1 : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] * -1 : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] * -1 : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] * -1 : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] * -1 : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] * -1 : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] * -1 : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] * -1 : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] * -1 : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] * -1 : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] * -1 : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] * -1 : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] * -1 : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] * -1 : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] * -1 : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] * -1 : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] * -1 : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] * -1 : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] * -1 : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] * -1 : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] * -1 : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] * -1 : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Other Sales Return</i></td>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>TOTAL RETURN PENJUALAN</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('421','422','429') group by a.id_ctg4 ) a");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] * -1 : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] * -1 : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] * -1 : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] * -1 : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] * -1 : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] * -1 : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] * -1 : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] * -1 : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] * -1 : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] * -1 : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] * -1 : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] * -1 : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] * -1 : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] * -1 : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] * -1 : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] * -1 : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] * -1 : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] * -1 : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] * -1 : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] * -1 : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] * -1 : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] * -1 : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] * -1 : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] * -1 : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>SALES RETURN TOTAL</i></b></th>
        </tr>
        
        <!-- return-penjualan - end -->

        <!-- potongan-penjualan - start -->
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>POTONGAN PENJUALAN</b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>SALES DISCOUNT</i></b></th>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Potongan Penjualan Pakaian Jadi Ekspor</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan * -1) saldo_jan,sum(saldo_feb * -1) saldo_feb,sum(saldo_mar * -1) saldo_mar,sum(saldo_apr * -1) saldo_apr,sum(saldo_may * -1) saldo_may,sum(saldo_jun * -1) saldo_jun,sum(saldo_jul * -1) saldo_jul,sum(saldo_aug * -1) saldo_aug,sum(saldo_sep * -1) saldo_sep,sum(saldo_oct * -1) saldo_oct,sum(saldo_nov * -1) saldo_nov,sum(saldo_dec * -1) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '431' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Garment Export Sales Discount</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Potongan Penjualan Pakaian Jadi Lokal</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan * -1) saldo_jan,sum(saldo_feb * -1) saldo_feb,sum(saldo_mar * -1) saldo_mar,sum(saldo_apr * -1) saldo_apr,sum(saldo_may * -1) saldo_may,sum(saldo_jun * -1) saldo_jun,sum(saldo_jul * -1) saldo_jul,sum(saldo_aug * -1) saldo_aug,sum(saldo_sep * -1) saldo_sep,sum(saldo_oct * -1) saldo_oct,sum(saldo_nov * -1) saldo_nov,sum(saldo_dec * -1) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '432' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Garment Local Sales Discount</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Potongan Penjualan Lainnya</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '438' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Other Sales Discount</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Potongan Penjualan Jasa Jahit Pakaian Jadi Ekspor</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '433' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Export Cmt Service Revenue Discount</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Potongan Penjualan Jasa Jahit Pakaian Jadi Lokal</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '434' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec * -1,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd * -1,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Local Cmt Service Revenue Discount</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Potongan Penjualan Jasa Lainnya</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '439' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Other Cmt Service Revenue Discount</i></td>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>TOTAL POTONGAN PENJUALAN</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan * -1) saldo_jan,sum(saldo_feb * -1) saldo_feb,sum(saldo_mar * -1) saldo_mar,sum(saldo_apr * -1) saldo_apr,sum(saldo_may * -1) saldo_may,sum(saldo_jun * -1) saldo_jun,sum(saldo_jul * -1) saldo_jul,sum(saldo_aug * -1) saldo_aug,sum(saldo_sep * -1) saldo_sep,sum(saldo_oct * -1) saldo_oct,sum(saldo_nov * -1) saldo_nov,sum(saldo_dec * -1) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('431','432','438','433','434','439') group by a.id_ctg4 ) a");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format($saldo_jan,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format($saldo_feb,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format($saldo_mar,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format($saldo_apr,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format($saldo_may,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format($saldo_jun,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format($saldo_jul,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format($saldo_aug,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format($saldo_sep,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format($saldo_oct,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format($saldo_nov,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format($saldo_dec,2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format($jumlah_ytd,2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>SALES DISCOUNT TOTAL</i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>PENJUALAN BERSIH</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,(saldo_awal_ - saldo_awal) saldo_awal,(saldo_jan_ - saldo_jan) saldo_jan,(saldo_feb_ - saldo_feb) saldo_feb,(saldo_mar_ - saldo_mar) saldo_mar,(saldo_apr_ - saldo_apr) saldo_apr,(saldo_may_ - saldo_may) saldo_may,(saldo_jun_ - saldo_jun) saldo_jun,(saldo_jul_ - saldo_jul) saldo_jul,(saldo_aug_ - saldo_aug) saldo_aug,(saldo_sep_ - saldo_sep) saldo_sep,(saldo_oct_ - saldo_oct) saldo_oct,(saldo_nov_ - saldo_nov) saldo_nov,(saldo_dec_ - saldo_dec) saldo_dec from (select '1' id,ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal_,sum(saldo_jan) saldo_jan_,sum(saldo_feb) saldo_feb_,sum(saldo_mar) saldo_mar_,sum(saldo_apr) saldo_apr_,sum(saldo_may) saldo_may_,sum(saldo_jun) saldo_jun_,sum(saldo_jul) saldo_jul_,sum(saldo_aug) saldo_aug_,sum(saldo_sep) saldo_sep_,sum(saldo_oct) saldo_oct_,sum(saldo_nov) saldo_nov_,sum(saldo_dec) saldo_dec_ from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('411','412','418','413','414','419','421','422','429') group by a.id_ctg4 ) a) a left JOIN

(select '1' id,ind_categori4 ind4,id_ctg4 idctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan * -1) saldo_jan,sum(saldo_feb * -1) saldo_feb,sum(saldo_mar * -1) saldo_mar,sum(saldo_apr * -1) saldo_apr,sum(saldo_may * -1) saldo_may,sum(saldo_jun * -1) saldo_jun,sum(saldo_jul * -1) saldo_jul,sum(saldo_aug * -1) saldo_aug,sum(saldo_sep * -1) saldo_sep,sum(saldo_oct * -1) saldo_oct,sum(saldo_nov * -1) saldo_nov,sum(saldo_dec * -1) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('431','432','438','433','434','439') group by a.id_ctg4 ) a) b on b.id = a.id


");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>NET SALES</i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        
        <!-- potongan-penjualan - end -->

        <!-- beban-pokok-penjualan - start -->
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>BEBAN POKOK PENJUALAN</b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>COST OF GOODS SOLD</i></b></th>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Harga Pokok Penjualan Pakaian Jadi Ekspor</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '511' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>cost of good sold for export sales</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Harga Pokok Penjualan Pakaian Jadi Lokal</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '512' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Cost of good sold for local sales</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Harga Pokok Penjualan Lainnya</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '518' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Cost of good sold for other sales</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Harga Pokok Penjualan Jasa Jahit Pakaian Jadi Ekspor</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '513' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Cost of revenue for export CMT service</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Harga Pokok Penjualan Jasa Jahit Pakaian Jadi Lokal</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '514' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Cost of revenue for local cmt service</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Harga Pokok Penjualan Jasa Jahit Lainnya</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '519' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Cost of revenue for other service</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Beban Penyesuaian Persediaan</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '591' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Inventory adjustment expense</i></td>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>HARGA POKOK PENJUALAN</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('511','512','518','513','514','519','591') group by a.id_ctg4 ) a");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>COST OF GOODS SOLD</i></b></th>
        </tr>

        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>LABA / (RUGI) KOTOR</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,(saldo_awal_ - saldo_awal) saldo_awal,(saldo_jan_ - saldo_jan) saldo_jan,(saldo_feb_ - saldo_feb) saldo_feb,(saldo_mar_ - saldo_mar) saldo_mar,(saldo_apr_ - saldo_apr) saldo_apr,(saldo_may_ - saldo_may) saldo_may,(saldo_jun_ - saldo_jun) saldo_jun,(saldo_jul_ - saldo_jul) saldo_jul,(saldo_aug_ - saldo_aug) saldo_aug,(saldo_sep_ - saldo_sep) saldo_sep,(saldo_oct_ - saldo_oct) saldo_oct,(saldo_nov_ - saldo_nov) saldo_nov,(saldo_dec_ - saldo_dec) saldo_dec from (select '1' id,ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal_,sum(saldo_jan) saldo_jan_,sum(saldo_feb) saldo_feb_,sum(saldo_mar) saldo_mar_,sum(saldo_apr) saldo_apr_,sum(saldo_may) saldo_may_,sum(saldo_jun) saldo_jun_,sum(saldo_jul) saldo_jul_,sum(saldo_aug) saldo_aug_,sum(saldo_sep) saldo_sep_,sum(saldo_oct) saldo_oct_,sum(saldo_nov) saldo_nov_,sum(saldo_dec) saldo_dec_ from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('411','412','418','413','414','419','421','422','429','511','512','518','513','514','519','591') group by a.id_ctg4 ) a) a left JOIN

(select '1' id,ind_categori4 ind4,id_ctg4 idctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan * -1) saldo_jan,sum(saldo_feb * -1) saldo_feb,sum(saldo_mar * -1) saldo_mar,sum(saldo_apr * -1) saldo_apr,sum(saldo_may * -1) saldo_may,sum(saldo_jun * -1) saldo_jun,sum(saldo_jul * -1) saldo_jul,sum(saldo_aug * -1) saldo_aug,sum(saldo_sep * -1) saldo_sep,sum(saldo_oct * -1) saldo_oct,sum(saldo_nov * -1) saldo_nov,sum(saldo_dec * -1) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('431','432','438','433','434','439') group by a.id_ctg4 ) a) b on b.id = a.id


");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(abs($saldo_jan),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(abs($saldo_feb),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(abs($saldo_mar),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(abs($saldo_apr),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(abs($saldo_may),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(abs($saldo_jun),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(abs($saldo_jul),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(abs($saldo_aug),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(abs($saldo_sep),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(abs($saldo_oct),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(abs($saldo_nov),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(abs($saldo_dec),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(abs($jumlah_ytd),2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>GROSS PROFIT / (LOSS)</i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 13%;"></th>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        
        <!-- beban-pokok-penjualan - end -->

        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Beban penjualan</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '611' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Selling expenses</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Beban administrasi dan umum</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '711' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>General and administrative expenses</i></td>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>LABA / (RUGI) SEBELUM BUNGA DAN PAJAK</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,(saldo_awal_ - saldo_awal) saldo_awal,(saldo_jan_ - saldo_jan) saldo_jan,(saldo_feb_ - saldo_feb) saldo_feb,(saldo_mar_ - saldo_mar) saldo_mar,(saldo_apr_ - saldo_apr) saldo_apr,(saldo_may_ - saldo_may) saldo_may,(saldo_jun_ - saldo_jun) saldo_jun,(saldo_jul_ - saldo_jul) saldo_jul,(saldo_aug_ - saldo_aug) saldo_aug,(saldo_sep_ - saldo_sep) saldo_sep,(saldo_oct_ - saldo_oct) saldo_oct,(saldo_nov_ - saldo_nov) saldo_nov,(saldo_dec_ - saldo_dec) saldo_dec from (select '1' id,ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal_,sum(saldo_jan) saldo_jan_,sum(saldo_feb) saldo_feb_,sum(saldo_mar) saldo_mar_,sum(saldo_apr) saldo_apr_,sum(saldo_may) saldo_may_,sum(saldo_jun) saldo_jun_,sum(saldo_jul) saldo_jul_,sum(saldo_aug) saldo_aug_,sum(saldo_sep) saldo_sep_,sum(saldo_oct) saldo_oct_,sum(saldo_nov) saldo_nov_,sum(saldo_dec) saldo_dec_ from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('411','412','418','413','414','419','421','422','429','511','512','518','513','514','519','591','611','711') group by a.id_ctg4 ) a) a left JOIN

(select '1' id,ind_categori4 ind4,id_ctg4 idctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan * -1) saldo_jan,sum(saldo_feb * -1) saldo_feb,sum(saldo_mar * -1) saldo_mar,sum(saldo_apr * -1) saldo_apr,sum(saldo_may * -1) saldo_may,sum(saldo_jun * -1) saldo_jun,sum(saldo_jul * -1) saldo_jul,sum(saldo_aug * -1) saldo_aug,sum(saldo_sep * -1) saldo_sep,sum(saldo_oct * -1) saldo_oct,sum(saldo_nov * -1) saldo_nov,sum(saldo_dec * -1) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('431','432','438','433','434','439') group by a.id_ctg4 ) a) b on b.id = a.id");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>PROFIT / (LOSS) BEFORE INTEREST AND TAX</i></b></th>
        </tr>

        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 13%;"></th>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>


        <!-- laba/rugi - sebelum pajak -->
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Beban bunga</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '821' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Interest expense</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Pendapatan bunga</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '814' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Interest income</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Laba / (Rugi) Selisih Kurs</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa  where no_coa IN ('8.52.01','8.52.02')
order by no_coa asc) a");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Forex exchange gain / loss</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Laba / (Rugi) Penjualan Aset Tetap</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '2000' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Gain / loss of FA sold</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Laba / (Rugi) Disposisi Aset Tetap</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '3000' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Gain / loss of FA disposal</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Pendapatan lain-lain</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '813' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Other income</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Beban lain-lain</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa  where no_coa IN ('8.53.01','8.54.01')
order by no_coa asc) a");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Other expense</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Pendapatan sewa</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '815' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Rent income</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Beban administrasi bank</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '822' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Bank adm expense</i></td>
        </tr>

        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>LABA / (RUGI) SEBELUM PAJAK</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,(saldo_awal_ - saldo_awal) saldo_awal,(saldo_jan_ - saldo_jan) saldo_jan,(saldo_feb_ - saldo_feb) saldo_feb,(saldo_mar_ - saldo_mar) saldo_mar,(saldo_apr_ - saldo_apr) saldo_apr,(saldo_may_ - saldo_may) saldo_may,(saldo_jun_ - saldo_jun) saldo_jun,(saldo_jul_ - saldo_jul) saldo_jul,(saldo_aug_ - saldo_aug) saldo_aug,(saldo_sep_ - saldo_sep) saldo_sep,(saldo_oct_ - saldo_oct) saldo_oct,(saldo_nov_ - saldo_nov) saldo_nov,(saldo_dec_ - saldo_dec) saldo_dec from (select '1' id,ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal_,sum(saldo_jan) saldo_jan_,sum(saldo_feb) saldo_feb_,sum(saldo_mar) saldo_mar_,sum(saldo_apr) saldo_apr_,sum(saldo_may) saldo_may_,sum(saldo_jun) saldo_jun_,sum(saldo_jul) saldo_jul_,sum(saldo_aug) saldo_aug_,sum(saldo_sep) saldo_sep_,sum(saldo_oct) saldo_oct_,sum(saldo_nov) saldo_nov_,sum(saldo_dec) saldo_dec_ from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('411','412','418','413','414','419','421','422','429','511','512','518','513','514','519','591','611','711','821','813','815','822') group by a.id_ctg4 ) a
UNION
select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa  where no_coa IN ('8.52.01','8.52.02','8.53.01','8.54.01')
order by no_coa asc) a) a) a left JOIN

(select '1' id,ind_categori4 ind4,id_ctg4 idctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan * -1) saldo_jan,sum(saldo_feb * -1) saldo_feb,sum(saldo_mar * -1) saldo_mar,sum(saldo_apr * -1) saldo_apr,sum(saldo_may * -1) saldo_may,sum(saldo_jun * -1) saldo_jun,sum(saldo_jul * -1) saldo_jul,sum(saldo_aug * -1) saldo_aug,sum(saldo_sep * -1) saldo_sep,sum(saldo_oct * -1) saldo_oct,sum(saldo_nov * -1) saldo_nov,sum(saldo_dec * -1) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('431','432','438','433','434','439','814') group by a.id_ctg4 ) a) b on b.id = a.id");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>PROFIT / (LOSS) BEFORE TAX</i></b></th>
        </tr>

        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 13%;"></th>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>

        <!-- -->
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Pajak Penghasilan Badan Kini</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '911' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Current corporate income tax</i></td>
        </tr>
        <tr>
            <td style="text-align: left;vertical-align: middle;width: 27%;">Pajak Penghasilan Badan Tangguhan</td>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 = '921' group by a.id_ctg4");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</td>
                <td style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</td>
                ';
            }else{

            }

        ?>
            <td style="text-align: right;vertical-align: middle;width: 27%;"><i>Deffered corporate income tax</i></td>
        </tr>

        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b></b></th>
            <th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>
            <?php
            $sql_periode1 = mysqli_query($conn2,"select DATE_FORMAT(periode, '%b %Y') periode from (select tgl_awal periode from tbl_tgl_tb where tgl_awal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_awal' and tahun = '$tahun_awal') and (select tgl_awal from tbl_tgl_tb where bulan = '$bulan_akhir' and tahun = '$tahun_akhir')) a");
             while($periode1 = mysqli_fetch_array($sql_periode1)){
            echo '<th style="text-align: right;vertical-align: middle;width: 10%;border-bottom: 1px solid black;"></th>';

        }; ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i></i></b></th>
        </tr>
        <tr>
            <th style="text-align: left;vertical-align: middle;width: 27%;"><b>LABA / (RUGI) BERSIH</b></th>
            <?php 
                $sql = mysqli_query($conn2,"select ind_categori4,id_ctg4,(saldo_awal_ - saldo_awal) saldo_awal,(saldo_jan_ - saldo_jan) saldo_jan,(saldo_feb_ - saldo_feb) saldo_feb,(saldo_mar_ - saldo_mar) saldo_mar,(saldo_apr_ - saldo_apr) saldo_apr,(saldo_may_ - saldo_may) saldo_may,(saldo_jun_ - saldo_jun) saldo_jun,(saldo_jul_ - saldo_jul) saldo_jul,(saldo_aug_ - saldo_aug) saldo_aug,(saldo_sep_ - saldo_sep) saldo_sep,(saldo_oct_ - saldo_oct) saldo_oct,(saldo_nov_ - saldo_nov) saldo_nov,(saldo_dec_ - saldo_dec) saldo_dec from (select '1' id,ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal_,sum(saldo_jan) saldo_jan_,sum(saldo_feb) saldo_feb_,sum(saldo_mar) saldo_mar_,sum(saldo_apr) saldo_apr_,sum(saldo_may) saldo_may_,sum(saldo_jun) saldo_jun_,sum(saldo_jul) saldo_jul_,sum(saldo_aug) saldo_aug_,sum(saldo_sep) saldo_sep_,sum(saldo_oct) saldo_oct_,sum(saldo_nov) saldo_nov_,sum(saldo_dec) saldo_dec_ from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('411','412','418','413','414','419','421','422','429','511','512','518','513','514','519','591','611','711','821','813','815','822','911','921') group by a.id_ctg4 ) a
UNION
select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa  where no_coa IN ('8.52.01','8.52.02','8.53.01','8.54.01')
order by no_coa asc) a) a) a left JOIN

(select '1' id,ind_categori4 ind4,id_ctg4 idctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan * -1) saldo_jan,sum(saldo_feb * -1) saldo_feb,sum(saldo_mar * -1) saldo_mar,sum(saldo_apr * -1) saldo_apr,sum(saldo_may * -1) saldo_may,sum(saldo_jun * -1) saldo_jun,sum(saldo_jul * -1) saldo_jul,sum(saldo_aug * -1) saldo_aug,sum(saldo_sep * -1) saldo_sep,sum(saldo_oct * -1) saldo_oct,sum(saldo_nov * -1) saldo_nov,sum(saldo_dec * -1) saldo_dec from (select ind_categori4,id_ctg4,sum(saldo_awal) saldo_awal,sum(saldo_jan) saldo_jan,sum(saldo_feb) saldo_feb,sum(saldo_mar) saldo_mar,sum(saldo_apr) saldo_apr,sum(saldo_may) saldo_may,sum(saldo_jun) saldo_jun,sum(saldo_jul) saldo_jul,sum(saldo_aug) saldo_aug,sum(saldo_sep) saldo_sep,sum(saldo_oct) saldo_oct,sum(saldo_nov) saldo_nov,sum(saldo_dec) saldo_dec from (select no_coa,nama_coa,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4,saldo_awal,saldo_jan,saldo_feb,saldo_mar,saldo_apr,saldo_may,saldo_jun,saldo_jul,saldo_aug,saldo_sep,saldo_oct,saldo_nov,saldo_dec from 
(select no_coa,nama_coa,'' beg_balance,ind_categori1,ind_categori2,ind_categori3,ind_categori4,id_ctg4 from mastercoa_v2 order by no_coa asc) coa
left join
(select nocoa coa_no, saldo saldo_awal,(saldo + coalesce((debit_idr - credit_idr),0)) saldo_jan from 
(select no_coa nocoa,jan_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '01' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '01' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jan on jan.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_feb from 
(select no_coa nocoa,feb_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '02' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '02' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) feb on feb.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_mar from 
(select no_coa nocoa,mar_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '03' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '03' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) mar on mar.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_apr from 
(select no_coa nocoa,apr_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '04' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '04' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) apr on apr.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_may from 
(select no_coa nocoa,may_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '05' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '05' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) may on may.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jun from 
(select no_coa nocoa,jun_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '06' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '06' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jun on jun.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_jul from 
(select no_coa nocoa,jul_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '07' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '07' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) jul on jul.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_aug from 
(select no_coa nocoa,aug_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '08' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '08' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) aug on aug.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_sep from 
(select no_coa nocoa,sep_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '09' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '09' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) sep on sep.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_oct from 
(select no_coa nocoa,oct_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '10' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '10' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) oct on oct.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_nov from 
(select no_coa nocoa,nov_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '11' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '11' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) nov on nov.coa_no = coa.no_coa left join

(select nocoa coa_no, (saldo + coalesce((debit_idr - credit_idr),0)) saldo_dec from 
(select no_coa nocoa,dec_2023 as saldo from saldo_awal_tb order by no_coa asc) saldo
left join
(select no_coa coa_no,sum(ROUND(credit * rate,2)) credit_idr,sum(ROUND(debit * rate,2)) debit_idr  from tbl_list_journal where tgl_journal BETWEEN (select tgl_awal from tbl_tgl_tb where bulan = '12' and tahun = '2023') and (select tgl_akhir from tbl_tgl_tb where bulan = '12' and tahun = '2023') group by no_coa) 
jnl on jnl.coa_no = saldo.nocoa order by nocoa asc) des on des.coa_no = coa.no_coa 
order by no_coa asc) a where a.id_ctg4 IN ('431','432','438','433','434','439','814') group by a.id_ctg4 ) a) b on b.id = a.id");

        $row = mysqli_fetch_array($sql);
        $saldo_awal = isset($row['saldo_awal']) ? $row['saldo_awal'] : 0;
        $saldo_jan = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb = isset($row['saldo_feb']) ? $row['saldo_feb'] : 0;
        $saldo_mar = isset($row['saldo_mar']) ? $row['saldo_mar'] : 0;
        $saldo_apr = isset($row['saldo_apr']) ? $row['saldo_apr'] : 0;
        $saldo_may = isset($row['saldo_may']) ? $row['saldo_may'] : 0;
        $saldo_jun = isset($row['saldo_jun']) ? $row['saldo_jun'] : 0;
        $saldo_jul = isset($row['saldo_jul']) ? $row['saldo_jul'] : 0;
        $saldo_aug = isset($row['saldo_aug']) ? $row['saldo_aug'] : 0;
        $saldo_sep = isset($row['saldo_sep']) ? $row['saldo_sep'] : 0;
        $saldo_oct = isset($row['saldo_oct']) ? $row['saldo_oct'] : 0;
        $saldo_nov = isset($row['saldo_nov']) ? $row['saldo_nov'] : 0;
        $saldo_dec = isset($row['saldo_dec']) ? $row['saldo_dec'] : 0;

        $saldo_jan_ = isset($row['saldo_jan']) ? $row['saldo_jan'] : 0;
        $saldo_feb_ = isset($row['saldo_feb']) ? $row['saldo_feb'] : $saldo_jan;
        $saldo_mar_ = isset($row['saldo_mar']) ? $row['saldo_mar'] : $saldo_feb;
        $saldo_apr_ = isset($row['saldo_apr']) ? $row['saldo_apr'] : $saldo_mar;
        $saldo_may_ = isset($row['saldo_may']) ? $row['saldo_may'] : $saldo_apr;
        $saldo_jun_ = isset($row['saldo_jun']) ? $row['saldo_jun'] : $saldo_may;
        $saldo_jul_ = isset($row['saldo_jul']) ? $row['saldo_jul'] : $saldo_jun;
        $saldo_aug_ = isset($row['saldo_aug']) ? $row['saldo_aug'] : $saldo_jul;
        $saldo_sep_ = isset($row['saldo_sep']) ? $row['saldo_sep'] : $saldo_aug;
        $saldo_oct_ = isset($row['saldo_oct']) ? $row['saldo_oct'] : $saldo_sep;
        $saldo_nov_ = isset($row['saldo_nov']) ? $row['saldo_nov'] : $saldo_oct;
        $saldo_dec_ = isset($row['saldo_dec']) ? $row['saldo_dec'] : $saldo_nov;
        
        if ($jmlper == '1') {
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                ';
            }elseif ($jmlper == '2') {
                $jumlah_ytd = $saldo_jan + $saldo_feb;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '3') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '4') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '5') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may; 
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '6') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '7') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '8') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '9') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '10') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '11') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }elseif ($jmlper == '12') {
                $jumlah_ytd = $saldo_jan + $saldo_feb + $saldo_mar + $saldo_apr + $saldo_may + $saldo_jun + $saldo_jul + $saldo_aug + $saldo_sep + $saldo_oct + $saldo_nov + $saldo_dec;
                echo '
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jan.'">'.number_format(($saldo_jan * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_feb.'">'.number_format(($saldo_feb * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_mar.'">'.number_format(($saldo_mar * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_apr.'">'.number_format(($saldo_apr * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_may.'">'.number_format(($saldo_may * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jun.'">'.number_format(($saldo_jun * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_jul.'">'.number_format(($saldo_jul * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_aug.'">'.number_format(($saldo_aug * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_sep.'">'.number_format(($saldo_sep * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_oct.'">'.number_format(($saldo_oct * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_nov.'">'.number_format(($saldo_nov * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$saldo_dec.'">'.number_format(($saldo_dec * -1),2).'</th>
                <th style="text-align: right;vertical-align: middle;width: 10%;" value="'.$jumlah_ytd.'">'.number_format(($jumlah_ytd * -1),2).'</th>
                ';
            }else{

            }

        ?>
            <th style="text-align: right;vertical-align: middle;width: 27%;"><b><i>NET INCOME / (LOSS)</i></b></th>
        </tr>
        
    </table>

</body>
</html>




